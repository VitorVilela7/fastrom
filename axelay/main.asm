; Axelay - FastROM activator v1.0
; By Vitor Vilela

lorom

; option to include strict testing mode
!strict ?= 0

if !strict == 1
    print "strict mode on"
endif

; Include general-purpose remaps
incsrc "new_discrete_long_remap.asm"
incsrc "new_indexed_long_remap.asm"

; Optional CPU meter for tracking slowdown
;incsrc "cpu_meter.asm"

; Enable FastROM and jump to FastROM area
org $008BBC
    JMP initialize

; Jump to the FastROM area on NMI
org $00FFEA
    dw nmi_start

org $00FFFA
    dw nmi_start
    
; Code for enabling/jumping to FastROM area
org $00FBBD
    nmi_start:
        JML $808DAE

    initialize:
        LDA $4210
        
		; activate FastROM on shadow area (bank $80+)
        LDA #$01
        STA $420D
        JML $808BBF

    warnpc $FFB0
	; 16 bytes reserved for CPU meter
    
; enable FastROM annotation
org $00FFD5
    db $30

; Remaps pointers to use FastROM
macro remap_pointer(addr, pointer)
    if !strict == 1
        assert read3(<addr>) == <pointer>
    endif
    
    org <addr>
        dl <pointer>|$800000
endmacro

%remap_pointer($04ADD7, $02BEED)
%remap_pointer($04ADDA, $02BEED)
%remap_pointer($04ADDD, $02BEED)
%remap_pointer($04ADE0, $02BEED)
%remap_pointer($04ADE3, $02BEED)
%remap_pointer($04ADE6, $02BEED)
%remap_pointer($04ADE9, $02BEED)
%remap_pointer($04ADEC, $02DAEE)
%remap_pointer($04ADEF, $039105)
%remap_pointer($04ADF2, $02BEED)
%remap_pointer($04ADF5, $02EEA4)
%remap_pointer($04ADF8, $02EB57)
%remap_pointer($04ADFB, $02BEED)
%remap_pointer($04ADFE, $02BEED)
%remap_pointer($04AE01, $000000)
%remap_pointer($04AE04, $000000)
%remap_pointer($04AE07, $000000)
%remap_pointer($04AE0A, $02BEED)
%remap_pointer($04AE0D, $02EFF8)
%remap_pointer($04AE10, $02F169)
%remap_pointer($04AE13, $05AA08)
%remap_pointer($04AE16, $05E62B)
%remap_pointer($04AE19, $02BEED)
%remap_pointer($04AE1C, $03C44D)
%remap_pointer($04AE1F, $000000)
%remap_pointer($04AE22, $000000)
%remap_pointer($04AE25, $000000)
%remap_pointer($04AE28, $03E2E3)
%remap_pointer($04AE2B, $03E875)
%remap_pointer($04AE2E, $02BEED)
%remap_pointer($04AE31, $000000)
%remap_pointer($04AE34, $02BEED)
%remap_pointer($04AE37, $02D25E)
%remap_pointer($04AE3A, $000000)
%remap_pointer($04AE3D, $02BEED)
%remap_pointer($04AE40, $02EC8E)
%remap_pointer($04AE43, $02BEED)
%remap_pointer($04AE46, $000000)
%remap_pointer($04AE49, $000000)
%remap_pointer($04AE4C, $02BEED)
%remap_pointer($04AE4F, $03CC64)
%remap_pointer($04AE52, $03CDAD)
%remap_pointer($04AE55, $03D764)
%remap_pointer($04AE58, $000000)
%remap_pointer($04AE5B, $03CE08)
%remap_pointer($04AE5E, $000000)
%remap_pointer($04AE61, $000000)
%remap_pointer($04AE64, $02BEED)
%remap_pointer($04AE67, $000000)
%remap_pointer($04AE6A, $03A336)
%remap_pointer($04AE6D, $02BEED)
%remap_pointer($04AE70, $03BDB8)
%remap_pointer($04AE73, $02BEED)
%remap_pointer($04AE76, $02BEED)
%remap_pointer($04AE79, $02BEED)
%remap_pointer($04AE7C, $02BEED)
%remap_pointer($04AE7F, $02BEED)
%remap_pointer($04AE82, $02BEED)
%remap_pointer($04AE85, $03C99A)
%remap_pointer($04AE88, $05F1A7)
%remap_pointer($04AE8B, $05E62B)
%remap_pointer($04AE8E, $02BEED)
%remap_pointer($04AE91, $000000)
%remap_pointer($04AE94, $05DEAF)
%remap_pointer($04AE97, $03A224)
%remap_pointer($04AE9A, $02BEED)
%remap_pointer($04AE9D, $05F3CE)
%remap_pointer($04AEA0, $02BEED)
%remap_pointer($04AEA3, $02D25E)
%remap_pointer($04AEA6, $05EA17)
%remap_pointer($04AEA9, $02BEED)
%remap_pointer($04AEAC, $038232)
%remap_pointer($04AEAF, $05DCC1)
%remap_pointer($04AEB2, $00ACD0)
%remap_pointer($04AEB5, $000000)
%remap_pointer($04AEB8, $05B979)
%remap_pointer($04AEBB, $000000)
%remap_pointer($04AEBE, $02BEED)
%remap_pointer($04AEC1, $02BEED)
%remap_pointer($04AEC4, $03CE32)
%remap_pointer($04AEC7, $05E826)
%remap_pointer($04AECA, $000000)
%remap_pointer($04AECD, $000000)
%remap_pointer($04AED0, $000000)
%remap_pointer($04AED3, $05E017)
%remap_pointer($04AED6, $02BEED)
%remap_pointer($04AED9, $02BEED)
%remap_pointer($04AEDC, $000000)
%remap_pointer($04AEDF, $038F8A)
%remap_pointer($04AEE2, $0386EC)
%remap_pointer($04AEE5, $038DFA)
%remap_pointer($04AEE8, $038B70)
%remap_pointer($04AEEB, $03886F)
%remap_pointer($04AEEE, $038C58)
%remap_pointer($04AEF1, $038A67)
%remap_pointer($04AEF4, $038583)
%remap_pointer($04AEF7, $02BEED)
%remap_pointer($04AEFA, $03EBFA)
%remap_pointer($04AEFD, $02BEED)
%remap_pointer($04AF00, $000000)
%remap_pointer($04AF03, $03CE32)
%remap_pointer($04AF06, $03D528)
%remap_pointer($04AF09, $05E936)
%remap_pointer($04AF0C, $05E783)
%remap_pointer($04AF0F, $02BEED)
%remap_pointer($04AF12, $02D817)
%remap_pointer($04AF15, $02D9E9)
%remap_pointer($04AF18, $02DB9F)
%remap_pointer($04AF1B, $02DED1)
%remap_pointer($04AF1E, $02D888)
%remap_pointer($04AF21, $05CD53)
%remap_pointer($04AF24, $05D5BB)
%remap_pointer($04AF27, $05D63B)
%remap_pointer($04AF2A, $03BDB8)
%remap_pointer($04AF2D, $02BEED)
%remap_pointer($04AF30, $03C021)
%remap_pointer($04AF33, $03EA26)
%remap_pointer($04AF36, $03C1CC)
%remap_pointer($04AF39, $03C4DD)
%remap_pointer($04AF3C, $03B6DD)
%remap_pointer($04AF3F, $03B972)
%remap_pointer($04AF42, $02BEED)
%remap_pointer($04AF45, $000000)
%remap_pointer($04AF48, $000000)
%remap_pointer($04AF4B, $05E281)
%remap_pointer($04AF4E, $03B9FD)
%remap_pointer($04AF51, $02BEED)
%remap_pointer($04AF54, $05EF9B)
%remap_pointer($04AF57, $05ED9E)
%remap_pointer($04AF5A, $05FE54)
%remap_pointer($04AF5D, $05F5AA)
%remap_pointer($04AF60, $02BEED)
%remap_pointer($04AF63, $02BEED)
%remap_pointer($04AF66, $03F970)
%remap_pointer($04AF69, $03A0D8)
%remap_pointer($04AF6C, $02D5BC)
%remap_pointer($04AF6F, $000000)
%remap_pointer($04AF72, $000000)
%remap_pointer($04AF75, $000000)
%remap_pointer($04AF78, $000000)
%remap_pointer($04AF7B, $02D723)
%remap_pointer($04AF7E, $000000)
%remap_pointer($04AF81, $039F1D)
%remap_pointer($04AF84, $02BEED)
%remap_pointer($04AF87, $03BBA5)
%remap_pointer($04AF8A, $03B58F)
%remap_pointer($04AF8D, $03BC7A)
%remap_pointer($04AF90, $03C7A9)
%remap_pointer($04AF93, $02D25E)
%remap_pointer($04AF96, $03C5DB)
%remap_pointer($04AF99, $02BEED)
%remap_pointer($04AF9C, $039BE6)
%remap_pointer($04AF9F, $039CF6)
%remap_pointer($04AFA2, $039E01)
%remap_pointer($04AFA5, $02BEED)
%remap_pointer($04AFA8, $02BEED)
%remap_pointer($04AFAB, $0393A3)
%remap_pointer($04AFAE, $02BEED)
%remap_pointer($04AFB1, $02BEED)
%remap_pointer($04AFB4, $02BEED)
%remap_pointer($04AFB7, $038381)
%remap_pointer($04AFBA, $02BEED)
%remap_pointer($04AFBD, $03831D)
%remap_pointer($04AFC0, $02BEED)
%remap_pointer($04AFC3, $038000)
%remap_pointer($04AFC6, $02BEED)
%remap_pointer($04AFC9, $02E956)
%remap_pointer($04AFCC, $02E647)
%remap_pointer($04AFCF, $02BEED)
%remap_pointer($04AFD2, $02E28B)
%remap_pointer($04AFD5, $048070)
%remap_pointer($04AFD8, $02BEED)
%remap_pointer($04AFDB, $02BEED)
%remap_pointer($04AFDE, $02BEED)
%remap_pointer($04AFE1, $02BEED)
%remap_pointer($04AFE4, $02BEED)
%remap_pointer($04AFE7, $02BEED)
%remap_pointer($04AFEA, $02BEED)
%remap_pointer($04AFED, $02BEED)
%remap_pointer($04AFF0, $05B739)
%remap_pointer($04AFF3, $02E4C3)
%remap_pointer($04AFF6, $02CF8B)
%remap_pointer($04AFF9, $02E380)
%remap_pointer($04AFFC, $02E09B)
%remap_pointer($04AFFF, $000000)
%remap_pointer($04B002, $02BEED)
%remap_pointer($04B005, $02BEED)
%remap_pointer($04B008, $02BEED)
%remap_pointer($04B00B, $02BEED)
%remap_pointer($04B00E, $02BEED)
%remap_pointer($04B011, $02BEED)
%remap_pointer($04B014, $03D133)
%remap_pointer($04B017, $02BEED)
%remap_pointer($04B01A, $02BEED)
%remap_pointer($04B01D, $02BEED)
%remap_pointer($04B020, $02BEED)
%remap_pointer($04B023, $02C91B)
%remap_pointer($04B026, $02BEED)
%remap_pointer($04B029, $02F992)
%remap_pointer($04B02C, $02FAD7)
%remap_pointer($04B02F, $02CC5E)
%remap_pointer($04B032, $02BEED)
%remap_pointer($04B035, $02BEED)
%remap_pointer($04B038, $05EAC4)
%remap_pointer($04B03B, $039769)
%remap_pointer($04B03E, $03C99B)
%remap_pointer($04B041, $0393A3)
%remap_pointer($04B044, $03C99B)
%remap_pointer($04B047, $02BEED)
%remap_pointer($04B04A, $03C99B)
%remap_pointer($04B04D, $02BEED)

%remap_pointer($04B050, $000000)
%remap_pointer($04B053, $02C4FD)
%remap_pointer($04B056, $02C52F)
%remap_pointer($04B059, $02C5BF)
%remap_pointer($04B05C, $02C63D)
%remap_pointer($04B05F, $02C55D)
%remap_pointer($04B062, $02C586)
%remap_pointer($04B065, $02DB1A)
%remap_pointer($04B068, $03915D)
%remap_pointer($04B06B, $0392CF)
%remap_pointer($04B06E, $02EEFC)
%remap_pointer($04B071, $02EBAF)
%remap_pointer($04B074, $02EDD7)
%remap_pointer($04B077, $000000)
%remap_pointer($04B07A, $000000)
%remap_pointer($04B07D, $000000)
%remap_pointer($04B080, $000000)
%remap_pointer($04B083, $000000)
%remap_pointer($04B086, $02F05D)
%remap_pointer($04B089, $02F1CB)
%remap_pointer($04B08C, $05AB22)
%remap_pointer($04B08F, $05E62B)
%remap_pointer($04B092, $05E62B)
%remap_pointer($04B095, $03C486)
%remap_pointer($04B098, $000000)
%remap_pointer($04B09B, $000000)
%remap_pointer($04B09E, $000000)
%remap_pointer($04B0A1, $03E3EE)
%remap_pointer($04B0A4, $03E973)
%remap_pointer($04B0A7, $05B3DC)
%remap_pointer($04B0AA, $000000)
%remap_pointer($04B0AD, $05B0B4)
%remap_pointer($04B0B0, $02D2AC)
%remap_pointer($04B0B3, $000000)
%remap_pointer($04B0B6, $05B580)
%remap_pointer($04B0B9, $02ECD2)
%remap_pointer($04B0BC, $02ED43)
%remap_pointer($04B0BF, $000000)
%remap_pointer($04B0C2, $03C142)
%remap_pointer($04B0C5, $02F45F)
%remap_pointer($04B0C8, $03CC98)
%remap_pointer($04B0CB, $03C99A)
%remap_pointer($04B0CE, $03D7A2)
%remap_pointer($04B0D1, $000000)
%remap_pointer($04B0D4, $03CE08)
%remap_pointer($04B0D7, $000000)
%remap_pointer($04B0DA, $00ACD0)
%remap_pointer($04B0DD, $000000)
%remap_pointer($04B0E0, $000000)
%remap_pointer($04B0E3, $03A3C4)
%remap_pointer($04B0E6, $000000)
%remap_pointer($04B0E9, $03BDB8)
%remap_pointer($04B0EC, $000000)
%remap_pointer($04B0EF, $02C6B7)
%remap_pointer($04B0F2, $02C6B7)
%remap_pointer($04B0F5, $03E81C)
%remap_pointer($04B0F8, $03ABCB)
%remap_pointer($04B0FB, $000000)
%remap_pointer($04B0FE, $03C99A)
%remap_pointer($04B101, $05F229)
%remap_pointer($04B104, $05E6D0)
%remap_pointer($04B107, $03E7A9)
%remap_pointer($04B10A, $000000)
%remap_pointer($04B10D, $05DF09)
%remap_pointer($04B110, $000000)
%remap_pointer($04B113, $05CE08)
%remap_pointer($04B116, $05F42C)
%remap_pointer($04B119, $000000)
%remap_pointer($04B11C, $02D32E)
%remap_pointer($04B11F, $05EA38)
%remap_pointer($04B122, $02F6BE)
%remap_pointer($04B125, $038276)
%remap_pointer($04B128, $05DD14)
%remap_pointer($04B12B, $00ACD0)
%remap_pointer($04B12E, $000000)
%remap_pointer($04B131, $05BA4F)
%remap_pointer($04B134, $000000)
%remap_pointer($04B137, $03AD45)
%remap_pointer($04B13A, $000000)
%remap_pointer($04B13D, $03CE32)
%remap_pointer($04B140, $05E862)
%remap_pointer($04B143, $05E862)
%remap_pointer($04B146, $05E862)
%remap_pointer($04B149, $05E862)
%remap_pointer($04B14C, $05E06A)
%remap_pointer($04B14F, $05E1C4)
%remap_pointer($04B152, $03D628)
%remap_pointer($04B155, $000000)
%remap_pointer($04B158, $038FD8)
%remap_pointer($04B15B, $03874E)
%remap_pointer($04B15E, $038E58)
%remap_pointer($04B161, $038C04)
%remap_pointer($04B164, $038908)
%remap_pointer($04B167, $038CAB)
%remap_pointer($04B16A, $038ACA)
%remap_pointer($04B16D, $0385FC)
%remap_pointer($04B170, $038D7D)
%remap_pointer($04B173, $03EC35)
%remap_pointer($04B176, $0390BE)
%remap_pointer($04B179, $000000)
%remap_pointer($04B17C, $03CE7D)
%remap_pointer($04B17F, $03D568)
%remap_pointer($04B182, $05E988)
%remap_pointer($04B185, $05E7CB)
%remap_pointer($04B188, $05C39A)
%remap_pointer($04B18B, $02D85B)
%remap_pointer($04B18E, $02DA39)
%remap_pointer($04B191, $02DC09)
%remap_pointer($04B194, $02DF15)
%remap_pointer($04B197, $02D8BD)
%remap_pointer($04B19A, $05CE43)
%remap_pointer($04B19D, $05D5BF)
%remap_pointer($04B1A0, $05D643)
%remap_pointer($04B1A3, $03BE36)
%remap_pointer($04B1A6, $05D865)
%remap_pointer($04B1A9, $03C076)
%remap_pointer($04B1AC, $03EA4A)
%remap_pointer($04B1AF, $03C389)
%remap_pointer($04B1B2, $03C4FE)
%remap_pointer($04B1B5, $03B733)
%remap_pointer($04B1B8, $03B99B)
%remap_pointer($04B1BB, $03E149)
%remap_pointer($04B1BE, $000000)
%remap_pointer($04B1C1, $000000)
%remap_pointer($04B1C4, $05E32F)
%remap_pointer($04B1C7, $03BA24)
%remap_pointer($04B1CA, $05E5F2)
%remap_pointer($04B1CD, $05EFDB)
%remap_pointer($04B1D0, $05EDF2)
%remap_pointer($04B1D3, $05FE8D)
%remap_pointer($04B1D6, $05F721)
%remap_pointer($04B1D9, $02C6DA)
%remap_pointer($04B1DC, $02C757)
%remap_pointer($04B1DF, $03F9F8)
%remap_pointer($04B1E2, $03A111)
%remap_pointer($04B1E5, $02D642)
%remap_pointer($04B1E8, $000000)
%remap_pointer($04B1EB, $000000)
%remap_pointer($04B1EE, $000000)
%remap_pointer($04B1F1, $000000)
%remap_pointer($04B1F4, $02D774)
%remap_pointer($04B1F7, $000000)
%remap_pointer($04B1FA, $03A00A)
%remap_pointer($04B1FD, $000000)
%remap_pointer($04B200, $03BC1A)
%remap_pointer($04B203, $03B5C4)
%remap_pointer($04B206, $03BC8B)
%remap_pointer($04B209, $03C843)
%remap_pointer($04B20C, $02D25E)
%remap_pointer($04B20F, $03C67B)
%remap_pointer($04B212, $03BCE6)
%remap_pointer($04B215, $039C2D)
%remap_pointer($04B218, $039D27)
%remap_pointer($04B21B, $039E5E)
%remap_pointer($04B21E, $02C8C6)
%remap_pointer($04B221, $03A86C)
%remap_pointer($04B224, $0393A3)
%remap_pointer($04B227, $0393A3)
%remap_pointer($04B22A, $0393A3)
%remap_pointer($04B22D, $0393A3)
%remap_pointer($04B230, $03840F)
%remap_pointer($04B233, $03AEBA)
%remap_pointer($04B236, $000000)
%remap_pointer($04B239, $03B1DA)
%remap_pointer($04B23C, $03810D)
%remap_pointer($04B23F, $03B098)
%remap_pointer($04B242, $02E99E)
%remap_pointer($04B245, $02E71D)
%remap_pointer($04B248, $02E8C2)
%remap_pointer($04B24B, $02E2CD)
%remap_pointer($04B24E, $04818F)
%remap_pointer($04B251, $02C7D0)
%remap_pointer($04B254, $02C800)
%remap_pointer($04B257, $048BED)
%remap_pointer($04B25A, $048000)
%remap_pointer($04B25D, $048030)
%remap_pointer($04B260, $04944D)
%remap_pointer($04B263, $0490E8)
%remap_pointer($04B266, $0490B2)
%remap_pointer($04B269, $05B7E7)
%remap_pointer($04B26C, $02E50E)
%remap_pointer($04B26F, $02D029)
%remap_pointer($04B272, $02E3C6)
%remap_pointer($04B275, $02E14E)
%remap_pointer($04B278, $000000)
%remap_pointer($04B27B, $02CAA1)
%remap_pointer($04B27E, $03FB62)
%remap_pointer($04B281, $03FE21)
%remap_pointer($04B284, $03FCE4)
%remap_pointer($04B287, $03FD7D)
%remap_pointer($04B28A, $03FEFA)
%remap_pointer($04B28D, $03D151)
%remap_pointer($04B290, $03FFD4)
%remap_pointer($04B293, $02BE81)
%remap_pointer($04B296, $02BE81)
%remap_pointer($04B299, $02BE81)
%remap_pointer($04B29C, $02C986)
%remap_pointer($04B29F, $02D459)
%remap_pointer($04B2A2, $02F9F0)
%remap_pointer($04B2A5, $02FB35)
%remap_pointer($04B2A8, $02CCC1)
%remap_pointer($04B2AB, $02CB7A)
%remap_pointer($04B2AE, $05EEDF)
%remap_pointer($04B2B1, $05EAEF)
%remap_pointer($04B2B4, $0397C7)
%remap_pointer($04B2B7, $03CA80)
%remap_pointer($04B2BA, $0394DE)
%remap_pointer($04B2BD, $03CA73)
%remap_pointer($04B2C0, $04FC2D)
%remap_pointer($04B2C3, $03CA2F)
%remap_pointer($04B2C6, $02FC4C)

%remap_pointer($04B2C9, $000000)
%remap_pointer($04B2CC, $028456)
%remap_pointer($04B2CF, $02850C)
%remap_pointer($04B2D2, $028656)
%remap_pointer($04B2D5, $03CE04)
%remap_pointer($04B2D8, $0286DB)
%remap_pointer($04B2DB, $03A26C)
%remap_pointer($04B2DE, $02871E)
%remap_pointer($04B2E1, $028835)
%remap_pointer($04B2E4, $028A2E)
%remap_pointer($04B2E7, $028A64)
%remap_pointer($04B2EA, $03D41C)
%remap_pointer($04B2ED, $028A9A)
%remap_pointer($04B2F0, $028B1D)
%remap_pointer($04B2F3, $028897)
%remap_pointer($04B2F6, $03BFCB)
%remap_pointer($04B2F9, $03D3DB)
%remap_pointer($04B2FC, $03B1DA)
%remap_pointer($04B2FF, $02C4F1)
%remap_pointer($04B302, $02F956)
%remap_pointer($04B305, $000000)
%remap_pointer($04B308, $028D27)
%remap_pointer($04B30B, $03B1DA)
%remap_pointer($04B30E, $000000)
%remap_pointer($04B311, $000000)
%remap_pointer($04B314, $000000)
%remap_pointer($04B317, $03BD7A)
%remap_pointer($04B31A, $03EA04)
%remap_pointer($04B31D, $028D87)
%remap_pointer($04B320, $03C017)
%remap_pointer($04B323, $05DA33)
%remap_pointer($04B326, $03AF95)
%remap_pointer($04B329, $03B1DA)
%remap_pointer($04B32C, $000000)
%remap_pointer($04B32F, $028169)
%remap_pointer($04B332, $03BDB8)
%remap_pointer($04B335, $02C4F1)
%remap_pointer($04B338, $03B1DA)
%remap_pointer($04B33B, $03BB38)
%remap_pointer($04B33E, $03CD5F)
%remap_pointer($04B341, $03BB79)
%remap_pointer($04B344, $028DD9)
%remap_pointer($04B347, $028E2F)
%remap_pointer($04B34A, $05E4B0)
%remap_pointer($04B34D, $02892A)
%remap_pointer($04B350, $02898F)
%remap_pointer($04B353, $0289C5)
%remap_pointer($04B356, $0289E6)
%remap_pointer($04B359, $028388)
%remap_pointer($04B35C, $028AE5)
%remap_pointer($04B35F, $03D2BF)
%remap_pointer($04B362, $028ABB)
%remap_pointer($04B365, $028420)
%remap_pointer($04B368, $0283E2)
%remap_pointer($04B36B, $03D339)
%remap_pointer($04B36E, $03D20C)
%remap_pointer($04B371, $02D594)
%remap_pointer($04B374, $03CE0C)
%remap_pointer($04B377, $028339)
%remap_pointer($04B37A, $0285D6)
%remap_pointer($04B37D, $028484)
%remap_pointer($04B380, $0397D7)
%remap_pointer($04B383, $028542)
%remap_pointer($04B386, $03CB76)
%remap_pointer($04B389, $02860C)
%remap_pointer($04B38C, $03CBD4)
%remap_pointer($04B38F, $03CBFF)
%remap_pointer($04B392, $02858D)
%remap_pointer($04B395, $02811D)

; Make MVNs use FastROM, if applicable.
macro remap_mvn(src, dest, addr)
    assert read1(<addr>+0) == $54
    
    if !strict == 1
        assert read1(<addr>+1) == <src>
        assert read1(<addr>+2) == <dest>
    endif
    
    !set_src = <src>|$80
    !set_dest = <dest>|$80
    
    if <src> > $6F
        !set_src = <src>
    endif
    
    if <dest> > $6F
        !set_dest = <dest>
    endif
    
    org <addr>
        MVN !set_src, !set_dest
endmacro

%remap_mvn($7E, $04, $008AA1)
%remap_mvn($7E, $7E, $008BEC)
%remap_mvn($7E, $7E, $008CB6)
%remap_mvn($7E, $7E, $008D3C)
%remap_mvn($00, $00, $0099C0)
%remap_mvn($00, $01, $009B6B)
%remap_mvn($00, $00, $009DD9)
%remap_mvn($7E, $7E, $00A284)
%remap_mvn($7F, $7F, $00A59E)
%remap_mvn($7F, $7F, $00A611)
%remap_mvn($7E, $04, $00A76F)
%remap_mvn($7E, $7E, $00ABA2)
%remap_mvn($7E, $04, $00B6A3)
%remap_mvn($7E, $04, $00B873)
%remap_mvn($7E, $1E, $00CC48)
%remap_mvn($00, $00, $00DAC8)
%remap_mvn($7E, $7E, $00DB58)
%remap_mvn($7E, $7E, $00DBE1)
%remap_mvn($7E, $7E, $00DBF7)
%remap_mvn($7E, $7E, $00DC0D)
%remap_mvn($7E, $7E, $00DC64)
%remap_mvn($7F, $7F, $00DD5D)
%remap_mvn($00, $00, $00E6A0)
%remap_mvn($00, $00, $00E700)
%remap_mvn($00, $00, $00E756)
%remap_mvn($00, $00, $00E7CD)
%remap_mvn($00, $00, $00E849)
%remap_mvn($7E, $7E, $00E8A6)
%remap_mvn($7E, $7E, $00EBA1)
%remap_mvn($7E, $7E, $00F6D9)
%remap_mvn($7E, $7E, $00F74F)
%remap_mvn($01, $01, $02AE47)
%remap_mvn($7F, $7F, $02C161)
%remap_mvn($7F, $7F, $02C1E7)
%remap_mvn($7E, $04, $02C223)
%remap_mvn($7E, $04, $02C866)
%remap_mvn($7E, $04, $02C878)
%remap_mvn($7E, $04, $02C88A)
%remap_mvn($7F, $7F, $02C8A4)
%remap_mvn($7E, $7E, $02E115)
%remap_mvn($00, $00, $03A349)
%remap_mvn($7E, $04, $03B72B)
%remap_mvn($00, $00, $03D770)
%remap_mvn($00, $01, $03ECE9)
%remap_mvn($00, $01, $03ECF5)
%remap_mvn($7E, $01, $03F06D)
%remap_mvn($7E, $7E, $03F196)
%remap_mvn($7F, $7F, $049C04)
%remap_mvn($7E, $7E, $04B900)
%remap_mvn($7E, $04, $058968)
%remap_mvn($7E, $04, $058D16)
%remap_mvn($7E, $04, $05919D)
%remap_mvn($7E, $04, $059875)
%remap_mvn($7E, $7E, $05BFFF)

macro remap_databank(prev_value, addr)
    if !strict == 1
        assert read1(<addr>+0) == $A9
        assert read1(<addr>+1) == <prev_value>
    endif
    
    org <addr>
        LDA.b #$80|<prev_value>
endmacro

macro remap_databank16(prev_value, addr)
    if !strict == 1
        assert read1(<addr>+0) == $A9
        assert read1(<addr>+1) == $00
        assert read1(<addr>+2) == <prev_value>
    endif
    
    org <addr>
        LDA.w #($80|<prev_value>)<<8
endmacro

; Bank 05 (16-bit)
%remap_databank16($05, $0597CF)

; Bank 01 (16-bit)
%remap_databank16($01, $059B9A)

; Bank 04
%remap_databank($04, $008B48)
%remap_databank($04, $02B664)
%remap_databank($04, $02B6D1)
%remap_databank($04, $02B73B)
%remap_databank($04, $0591EA)
%remap_databank($04, $059263)

; Bank 01
%remap_databank($01, $008B95)
%remap_databank($01, $008BAF)
%remap_databank($01, $008DBC)
%remap_databank($01, $00914B)
%remap_databank($01, $00915F)
%remap_databank($01, $00918E)
%remap_databank($01, $00C530)
%remap_databank($01, $00C615)
%remap_databank($01, $00ECDF)
%remap_databank($01, $00EE3E)
%remap_databank($01, $00EEFA)
%remap_databank($01, $00EF9B)
%remap_databank($01, $00F03C)
%remap_databank($01, $00F0DD)
%remap_databank($01, $00F1A4)
%remap_databank($01, $00F245)
%remap_databank($01, $00F2E6)
%remap_databank($01, $00F387)

; Bank 1F
%remap_databank($1F, $00B87D)
%remap_databank($1F, $00B900)

; Bank 1E
%remap_databank($1E, $00D982)
%remap_databank($1E, $00D9A6)
%remap_databank($1E, $00D9C9)
%remap_databank($1E, $0483A8)
%remap_databank($1E, $0485BE)
%remap_databank($1E, $048ACF)
%remap_databank($1E, $05ACBB)

; Bank 1A
%remap_databank($1A, $05D58C)

; Bank 13
%remap_databank($13, $02A6EA)
%remap_databank($13, $02A700)
%remap_databank($13, $02A73A)
%remap_databank($13, $02A750)
%remap_databank($13, $02A788)
%remap_databank($13, $02A79E)
%remap_databank($13, $02A7D6)
%remap_databank($13, $02A7EC)
